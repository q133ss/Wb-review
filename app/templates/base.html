<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ИИ ответы WB</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}" />
  </head>
  <body>
    <div class="bg-glow"></div>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand">
          <div class="brand-mark">WB</div>
          <div>
            <div class="brand-title">ИИ ответы</div>
          </div>
        </div>
        <nav class="nav">
          <a class="nav-link {{ 'active' if tab == 'inbox' else '' }}" href="{{ url_for('admin', tab='inbox', marketplace_id=selected_marketplace_id) if selected_marketplace_id else url_for('admin', tab='inbox') }}">Входящие</a>
          <a class="nav-link {{ 'active' if tab == 'sent' else '' }}" href="{{ url_for('admin', tab='sent', marketplace_id=selected_marketplace_id) if selected_marketplace_id else url_for('admin', tab='sent') }}">Отправленные</a>
          <a class="nav-link {{ 'active' if tab == 'examples' else '' }}" href="{{ url_for('admin', tab='examples', marketplace_id=selected_marketplace_id) if selected_marketplace_id else url_for('admin', tab='examples') }}">Примеры ИИ</a>
          <a class="nav-link {{ 'active' if tab == 'accounts' else '' }}" href="{{ url_for('admin', tab='accounts') }}">Аккаунты</a>
        </nav>
        {% if accounts_by_type %}
          <div class="account-switch">
            <div class="label">Аккаунты</div>
            <a class="account-link {{ 'active' if not selected_marketplace_id else '' }}" href="{{ url_for('admin', tab=tab) }}">Все аккаунты</a>
            {% for group in accounts_by_type %}
              <details class="account-group">
                <summary class="account-group-trigger">{{ group["label"] }}</summary>
                <div class="account-items">
                  {% for account in group["accounts"] %}
                    <a class="account-link {{ 'active' if selected_marketplace_id == account['marketplace_id'] else '' }}" href="{{ url_for('admin', tab=tab, marketplace_id=account['marketplace_id']) }}">{{ account["account_name"] }}</a>
                  {% endfor %}
                </div>
              </details>
            {% endfor %}
          </div>
        {% endif %}
        <form class="logout" method="post" action="{{ url_for('logout') }}">
          <button class="btn ghost" type="submit">Выйти</button>
        </form>
      </aside>

      <div class="content">
        <main class="shell">
          {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
              <div class="alerts">
                {% for category, message in messages %}
                  <div class="alert {{ category }}">{{ message }}</div>
                {% endfor %}
              </div>
            {% endif %}
          {% endwith %}
          {% block content %}{% endblock %}
        </main>
      </div>
    </div>
  </body>
</html>
